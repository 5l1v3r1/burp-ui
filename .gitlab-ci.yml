before_script:
  - git submodule update --init

stages:
  - test
  - build
  - deploy

test:py2.7:
  stage: test
  image: ziirish/python:2.7
  script:
  - /bin/bash test/run_tests.sh
  tags:
  - docker
  except:
  - tags

test:py3.4:
  stage: test
  image: ziirish/python:3.4
  script:
  - /bin/bash test/run_tests.sh
  tags:
  - docker
  except:
  - tags

build:py2:
  stage: build
  script:
  - /bin/bash test/run_build.sh
  tags:
  - build
  only:
  - master
#  artifacts:
#    path:
#    - dist/

build:py3:
  stage: build
  image: ziirish/python:3.4
  script:
  - /bin/bash test/run_build.sh
  tags:
  - build
  only:
  - master
#  artifacts:
#    paths:
#    - dist/
